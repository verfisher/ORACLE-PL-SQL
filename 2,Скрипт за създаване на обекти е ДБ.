CREATE TABLE taxpayer (
    id       NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name     VARCHAR2(100),
    egn      NUMBER,
    type     NUMBER,
    bulstat  NUMBER,
    caddress VARCHAR2(200)
);

CREATE TABLE taxpayer_info (
    taxpayer_id        NUMBER PRIMARY KEY,
    has_representative CHAR(1) CHECK (has_representative IN ('Y','N')),
    reason             VARCHAR2(4000),
    email              VARCHAR2(200),
    CONSTRAINT fk_taxpayer_info FOREIGN KEY (taxpayer_id) REFERENCES taxpayer(id)
);

CREATE TABLE representative (
    id          NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    taxpayer_id NUMBER,
    name        VARCHAR2(100),
    egn         NUMBER,
    type        NUMBER,
    CONSTRAINT fk_representative FOREIGN KEY (taxpayer_id) REFERENCES taxpayer(id)
);

CREATE TABLE document (
    id          NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    taxpayer_id NUMBER,
    doc_id      VARCHAR2(100),
    CONSTRAINT fk_document FOREIGN KEY (taxpayer_id) REFERENCES taxpayer(id)
);
CREATE TABLE document_field (
    id          NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    document_id NUMBER,
    name        VARCHAR2(200),
    value       VARCHAR2(4000),
    CONSTRAINT fk_document_field FOREIGN KEY (document_id) REFERENCES document(id)
);
